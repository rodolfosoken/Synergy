<!DOCTYPE html>
<ui:composition template="/WEB-INF/templates/Layout.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<ui:define name="title">Montagem</ui:define>
	<ui:define name="body">

		<h1>Conjuntos</h1>
		<h:form id="frm">
			<p:messages id="messages" />
			<p:growl id="growl" />

			<p:tabView id="tabView">
				
				<p:tab title="Edição de Conjunto">

					<p:toolbar id="toolbar" style="margin-bottom:5px">

						<f:facet name="right">
							<span class="ui-separator"> <span
								class="ui-icon ui-icon-grip-dotted-vertical" />
							</span>

							<p:commandButton value="Salvar Conjunto" icon=" ui-icon-disk"
								action="#{conjuntoBean.salvarConjunto}"
								process="@this cadastro-conjuntos" update="frm">
							</p:commandButton>

						</f:facet>
					</p:toolbar>


					<p:fieldset legend="Conjunto" toggleable="true" toggleSpeed="500">


						<p:panelGrid id="cadastro-conjuntos" columns="4"
							style="margin-bottom:5px">


							<p:outputLabel value="PN Less: " for="pn" />
							<p:inputText id="pn"
								value="#{conjuntoBean.conjuntoEdicao.pnLess}" />

							<p:outputLabel value="Descrição" for="descricao" />
							<p:inputText id="descricao" size="45"
								value="#{conjuntoBean.conjuntoEdicao.desc}" />

							<p:outputLabel value="UPC FNA " for="upcFna" />
							<p:inputText id="upcFna"
								value="#{conjuntoBean.conjuntoEdicao.upcFna}" />

							<p:outputLabel value="FNA Descrição" for="fnaDesc" />
							<p:inputText id="fnaDesc" size="45"
								value="#{conjuntoBean.conjuntoEdicao.fnaDesc}" />

						</p:panelGrid>

					</p:fieldset>

					<p:fieldset legend="Montagens" toggleable="true" toggleSpeed="500"
						id="field-montagem">


						<p:panelGrid id="cadastro-montagem" columns="7"
							style="margin-bottom:5px">
							<f:facet name="header">
							Montagem
						</f:facet>

							<p:outputLabel value="Peça: " for="peca" />
							<p:autoComplete id="peca" dropdown="true"
								completeMethod="#{conjuntoBean.completarPeca}" var="peca"
								itemLabel="#{peca.partName}" itemValue="#{peca}"
								forceSelection="true" converter="pecaConverter" required="true"
								value="#{conjuntoBean.montagem.peca}" />
							<p:spacer width="10" height="10" />

							<p:outputLabel value="Ferramenta: " for="ferramenta" />
							<p:autoComplete id="ferramenta" dropdown="true"
								completeMethod="#{conjuntoBean.completarFerramenta}"
								var="ferramenta" itemLabel="#{ferramenta.nome}"
								itemValue="#{ferramenta}" forceSelection="true"
								converter="ferramentaConverter" required="true"
								value="#{conjuntoBean.montagem.ferramenta}" />
							<p:spacer width="10" height="10" />

							<p:commandButton value="Adicionar"
								action="#{conjuntoBean.adicionarMontagem}"
								update="field-montagem :frm:messages"
								process="@this cadastro-montagem" />


						</p:panelGrid>

						<p:commandButton value="Remover" style="margin-bottom:5px"
							action="#{conjuntoBean.removerMontagem}"
							update="@this field-montagem :frm:messages" process="@this"
							disabled="#{conjuntoBean.montagemSelecionada==null}" />


						<p:dataTable id="montagem-table"
							value="#{conjuntoBean.conjuntoEdicao.montagems}" var="montagem"
							emptyMessage="Nenhuma montagem adicionada"
							selection="#{conjuntoBean.montagemSelecionada}"
							selectionMode="single" rowKey="#{montagem}">

							<!-- Quando selecionar disparar evento -->
							<p:ajax event="rowSelect" update=":frm:tabView:field-montagem" />
							<p:ajax event="rowUnselect" update=":frm:tabView:field-montagem" />

							<p:column headerText="Peça">
								<h:outputText value="#{montagem.peca.partName}" />
							</p:column>

							<p:column headerText="Ferramenta">
								<h:outputText value="#{montagem.ferramenta.nome}" />
							</p:column>

						</p:dataTable>


					</p:fieldset>
				</p:tab>


				<p:tab title="Conjuntos" id="tabConjuntos">
				
					<p:dataTable id="conjuntos-table" value="#{conjuntoBean.todos}"
						var="conjunto" emptyMessage="Nenhum conjunto encontrado"
						 rowKey="#{conjunto}">


						<p:column headerText="ID">
							<h:outputText value="#{conjunto.idconjunto}" />
						</p:column>

						<p:column headerText="Pn Less">
							<h:outputText value="#{conjunto.pnLess}" />
						</p:column>

						<p:column headerText="Descrição">
							<h:outputText value="#{conjunto.desc}" />
						</p:column>

						<p:column headerText="UPC FNA">
							<h:outputText value="#{conjunto.upcFna}" />
						</p:column>

						<p:column headerText="FNA Descricao">
							<h:outputText value="#{conjunto.fnaDesc}" />
						</p:column>

					</p:dataTable>

				</p:tab>

			</p:tabView>








		</h:form>
	</ui:define>
</ui:composition>