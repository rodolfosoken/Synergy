<!DOCTYPE html>
<ui:composition template="/WEB-INF/templates/Layout.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<ui:define name="title">Cotação Ferramenta</ui:define>
	<ui:define name="body">
		<h:form id="frm">
			<p:toolbar id="toolbar">
				<f:facet name="left">
					<p:commandButton value="Editar" icon="ui-icon-folder-open"
						update="cotacao-dialog :frm:tabView" process="@this"
						oncomplete="PF('edicaoCotacaoDialog').show()" action="#{cotacaoFerramentaBean.editar}"
						disabled="#{cotacaoFerramentaBean.cotacaoSelecionada==null}">
						
					</p:commandButton>
				</f:facet>
			</p:toolbar>

			<p:dataTable value="#{cotacaoFerramentaBean.todas}" var="cotacao"
				emptyMessage="Nenhuma cotação cadastrada." id="cotacoes-table"
				paginator="true" paginatorPosition="bottom" rows="20"
				selection="#{cotacaoFerramentaBean.cotacaoSelecionada}"
				selectionMode="single" rowKey="#{cotacao.idcotacao}">

				<!-- Quando selecionar disparar evento -->
				<p:ajax event="rowSelect" update=":frm:toolbar" />
				<p:ajax event="rowUnselect" update=":frm:toolbar" />

				<p:column headerText="ID">
					<h:outputText value="#{cotacao.idcotacao}" />
				</p:column>

				<p:column headerText="Responsável">
					<h:outputText value="#{cotacao.usuario.nome}" />
				</p:column>

				<p:column headerText="Data início">
					<h:outputText value="#{cotacao.dataInicio}" />
				</p:column>

				<p:column headerText="Previsão de término">
					<h:outputText value="#{cotacao.dataPrevisao}" />
				</p:column>

				<p:column headerText="Descrição">
					<h:outputText value="#{cotacao.descricao}" />
				</p:column>

			</p:dataTable>
			<p:dialog widgetVar="edicaoCotacaoDialog" id="cotacao-dialog"
				modal="true"  closeOnEscape="true"  
				header="Cotação" resizable="false">
				<p:scrollPanel mode="native"  style="height:450px">
				<h1>Editor de Cotação Ferramenta</h1>
				
				<ui:include src="/ferramentas/template/editarCotacao.xhtml" />
				</p:scrollPanel>
			
			</p:dialog>

		</h:form>
	</ui:define>
</ui:composition>
